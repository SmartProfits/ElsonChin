<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A4 表格範本</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            width: 230mm;
            height: 297mm;
            box-sizing: border-box;
        }
        .container {
            width: 100%;
            height: 100%;
            padding: 20mm;
            box-sizing: border-box;
        }
        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .header div {
            flex: 1;
        }
        .header select {
            border: none;
            font-size: 16px;
            outline: none;
            width: 80%;
            text-align: center;
        }
        .header input[type="date"] {
            border: none;
            font-size: 16px;
            outline: none;
            width: 80%;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th:nth-child(5), td:nth-child(5),
th:nth-child(10), td:nth-child(10) {
    width: 120px; /* 这里设置总计列的宽度为 120px，可以根据需求调整 */
}

th:nth-child(1), td:nth-child(1),
th:nth-child(6), td:nth-child(6) {
    width: 60px; /*客戶/現金 */
}
th:nth-child(3), td:nth-child(3),
th:nth-child(8), td:nth-child(8) {
    width: 20px; /*客戶/現金 */
}
th:nth-child(4), td:nth-child(4),
th:nth-child(9), td:nth-child(9) {
    width: 20px; /*客戶/現金 */
}


        
        th:nth-child(2), td:nth-child(2),
        th:nth-child(7), td:nth-child(7) {
            width: 250px; /* 調整貨品列寬度 */
        }
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 8px;
            white-space: nowrap;
        }
        input {
            width: 100%;
            border: none;
            text-align: center;
            outline: none;
        }
        /* 隐藏数字输入框的上下箭头 */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield; /* Firefox 隐藏箭头 */
            appearance: none; /* 通用隐藏箭头 */
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <div>
                <strong>船牌:</strong>
                <select>
					<option value="选择船牌">选择船牌</option>
                    <option value="SJN1828/F">SJN1828/F</option>
                    <option value="SJN1229/F">SJN1229/F</option>
                </select>
            </div>
            <div style="text-align: right;">
                <strong>日期:</strong> <input type="date" />
            </div>
        </div>

        <!-- Table Section -->
        <table>
            <thead>
                <tr>
                    <th style="white-space: nowrap;">客戶/現金</th>
                    <th>貨品</th>
                    <th>重量</th>
                    <th>單價</th>
                    <th>總計</th>
                    <th style="white-space: nowrap;">客戶/現金</th>
                    <th>貨品</th>
                    <th>重量</th>
                    <th>單價</th>
                    <th>總計</th>
                </tr>
            </thead>
            <tbody>
                <!-- Example row -->
                <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                 <tr>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                    <td><input type="text"></td>
                    <td>
                        <input type="text" class="product" placeholder="">
                    </td>
                    <td><input type="number" class="weight" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="price" oninput="calculateTotal(this)"></td>
                    <td><input type="text" class="total" readonly></td>
                </tr>
                
            </tbody>
        </table>
    </div>

    <script>
        // 快捷字列表
        const productOptions = [
            "Basong",
            "Basong (m)",
            "Basong (ks)",
            "Tulai",
            "Tulai (m)",
            "Tulai (s)",
            "Tulai (ss)",
            "Lumahan",
            "Lumahan (m)",
            "Bubu",
            "Titir (s)",
            "Tenggiri",
            "Tenggiri (s)"
        ];

        // 为所有货品输入框绑定输入事件
        document.querySelectorAll('tbody tr').forEach(row => {
    const price4Cell = row.querySelector('td:nth-child(4) .price'); // 第4格
    const price9Cell = row.querySelector('td:nth-child(9) .price'); // 第9格

    // 为第4列绑定双击事件
    if (price4Cell) {
        price4Cell.addEventListener('dblclick', () => {
            if (price4Cell.dataset.calculated === 'true') return; // 如果已经计算过，直接返回

            price4Cell.value = 'Total'; // 设置当前单元格为 "Total"
            calculateGroupTotal(5, row.querySelector('td:nth-child(5) .total')); // 更新第5列总计
            price4Cell.dataset.calculated = 'true'; // 设置标记，防止重复计算
        });
    }

    // 为第9列绑定双击事件
    if (price9Cell) {
        price9Cell.addEventListener('dblclick', () => {
            if (price9Cell.dataset.calculated === 'true') return; // 如果已经计算过，直接返回

            price9Cell.value = 'Total'; // 设置当前单元格为 "Total"
            calculateGroupTotal(10, row.querySelector('td:nth-child(10) .total'), true); // 更新第10列总计
            price9Cell.dataset.calculated = 'true'; // 设置标记，防止重复计算
        });
    }
});

// 输入事件，用于实时计算单行总计
function calculateTotal(element) {
    const row = element.parentElement.parentElement; // 获取当前行
    const cells = row.querySelectorAll('td'); // 获取当前行的所有单元格

    // 第一组（第3、4格子到第5格子）
    const weight1 = parseFloat(cells[2].querySelector('.weight').value) || 0;
    const price1 = parseFloat(cells[3].querySelector('.price').value) || 0;
    const total1 = cells[4].querySelector('.total');

    if (weight1 && price1) {
        total1.value = calculateResult(weight1, price1); // 计算并更新总计
    } else {
        total1.value = ''; // 输入不全时清空
    }

    // 第二组（第8、9格子到第10格子）
    const weight2 = parseFloat(cells[7].querySelector('.weight').value) || 0;
    const price2 = parseFloat(cells[8].querySelector('.price').value) || 0;
    const total2 = cells[9].querySelector('.total');

    if (weight2 && price2) {
        total2.value = calculateResult(weight2, price2); // 计算并更新总计
    } else {
        total2.value = ''; // 输入不全时清空
    }
}

// 计算总和
function calculateGroupTotal(columnIndex, targetCell, includePreviousColumn = false) {
    let sum = 0;

    // 遍历所有行并累加指定列的值
    document.querySelectorAll('tbody tr').forEach(row => {
        const cell = row.querySelector(`td:nth-child(${columnIndex}) .total`);
        if (cell && cell.value && cell.value.trim().toLowerCase() !== 'total') {
            sum += parseFloat(cell.value) || 0;
        }
    });

    // 如果需要累加上一列的值
    if (includePreviousColumn) {
        document.querySelectorAll('tbody tr').forEach(row => {
            const cell = row.querySelector(`td:nth-child(${columnIndex - 5}) .total`);
            if (cell && cell.value && cell.value.trim().toLowerCase() !== 'total') {
                sum += parseFloat(cell.value) || 0;
            }
        });
    }

    // 更新目标单元格
    targetCell.value = sum.toFixed(2);
}

function calculateResult(weight, price) {
    const result = weight * price;
    return Number.isInteger(result) ? result : result.toFixed(2); // 整数不显示小数点，小数保留两位
}

    </script>
</body>
</html>
